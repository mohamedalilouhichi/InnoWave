<!doctype html>
<html lang="en">
<body>

<app-header [pageTitle]="'RealTime Chat'"></app-header>

<body>


<main>
  <section class="section">
    <div class="container">
      <input type="number" [(ngModel)]="receiver" placeholder="Receiver ID">

      <div class="chat">
        <div class="chat-title">
          <h2>User1</h2>
          <figure class="avatar"><img src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/764024/profile/profile-512.jpg" alt="Profile Picture"></figure>
        </div>

        <div class="messages">

          <div class="messages-content">

            <ng-container *ngFor="let message of messages; let last = last">

              <ng-container *ngIf="message.receiver.idUser == sender && message.sender.idUser == receiver">
                
                <div class="message">
                  <div class="message-class">
                    <div class="message-content"
                         (mouseenter)="showDateTime = true"
                         (mouseleave)="showDateTime = false">

                      <div *ngIf="message.reactions && message.reactions.length > 0"
                           class="reactions">
                        <span *ngFor="let reaction of message.reactions">{{ reaction }}</span>
                      </div>

                      <div class="popup" *ngIf="showDateTime">
                        {{ formatDate(message.date) }}
                      </div>

                      {{ message.content }}

                      <button class="reaction-button"
                              (mouseenter)="showDateTime = false"
                              (mouseleave)="showDateTime = false"
                              (click)="toggleReactionOptions(message.idMessage)">☺</button>
                      <button class="select-button"
                              (mouseenter)="showDateTime = false"
                              (mouseleave)="showDateTime = false"
                              (click)="replyToMessage(message.idMessage)">⋮</button>

                      <div class="reaction-popupR reaction-buttons-container"
                           *ngIf="showReactionOptions[message.idMessage]"
                           (mouseleave)="hideReactionOptions(message.idMessage)">
                        <button (click)="addReaction(message.idMessage, '👍')">👍</button>
                        <button (click)="addReaction(message.idMessage, '❤️')">❤️</button>
                        <button (click)="addReaction(message.idMessage, '😂')">😂</button>
                        <button (click)="addReaction(message.idMessage, '😯')">😯</button>
                        <button (click)="addReaction(message.idMessage, '😢')">😢</button>
                        <button (click)="addReaction(message.idMessage, '😡')">😡</button>
                        <!-- Add more reaction buttons as needed -->
                      </div>
                    </div>
                  </div>
                </div>
              </ng-container>

              <div class="message-container">
                <div class="message2" *ngIf="message.receiver.idUser == receiver && message.sender.idUser == sender">
                  <div class="message-content">
                    {{ message.content }}

                    <div class="popup" *ngIf="showDateTime">
                      {{ formatDate(message.date) }}
                    </div>

                    <button class="select-button2"
                            *ngIf="message.content != delMsg"
                            (click)="deleteMessag(message.idMessage)">⋮</button>
                    <button class="reaction-button2"
                            (click)="toggleReactionOptions(message.idMessage)">☺</button>

                    <div class="reaction-popup2 reaction-buttons-container2"
                         *ngIf="showReactionOptions[message.idMessage]"
                         (mouseleave)="hideReactionOptions(message.idMessage)">
                      <button (click)="addReaction(message.idMessage, '👍')">👍</button>
                      <button (click)="addReaction(message.idMessage, '❤️')">❤️</button>
                      <button (click)="addReaction(message.idMessage, '😂')">😂</button>
                      <button (click)="addReaction(message.idMessage, '😯')">😯</button>
                      <button (click)="addReaction(message.idMessage, '😢')">😢</button>
                      <button (click)="addReaction(message.idMessage, '😡')">😡</button>
                      <!-- Add more reaction buttons as needed -->
                    </div>

                    <div class="lastmsg-time" *ngIf="last">
                      {{ getTimeDifference(message.date) }}
                    </div>
                  </div>
                </div>
              </div>
            </ng-container>
          </div>
        </div>

        <div class="action-box">
          <textarea class="action-box-input" [(ngModel)]="newMessage" placeholder="Type message..."></textarea>
          <button class="action-box-submit" (click)="addMessage()"><i class="fa fa-paper-plane"></i> Send</button>
        </div>
      </div>
    </div>
  </section>
</main>

<app-footer></app-footer>

</body>

